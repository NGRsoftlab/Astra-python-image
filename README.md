<!-- markdownlint-disable MD033 MD041 -->
<p><img src="https://static.tildacdn.com/tild3733-3430-4331-a637-336233396534/logo.svg" alt="NGRSOFTLAB logo" title="NGR" align="right" height="60" /></p>
<!-- markdownlint-enable MD033 MD041 -->

# Python

<!-- markdownlint-disable MD033 -->
<div>
  <h4 align="center">
    <img src="https://img.shields.io/badge/Dive%20efficiency-100%25-brightgreen.svg?logo=Docker&style=plastic" alt="Dive efficiency"/>
    <img src="https://img.shields.io/badge/Made%20with-%E2%9D%A4%EF%B8%8F-9cf?style=plastic" alt="Made with love"/>
    <img src="https://img.shields.io/badge/Powered%20by-Docker-blue?logo=Docker&style=plastic" alt="Powered by Docker"/>
    <img src="https://shields.io/badge/NGR -Team-yellow?style=plastic&logo=data:image/svg%2bxml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGZpbGw9Im5vbmUiIHZpZXdCb3g9IjIyLjcgMCA1MS45IDUxLjciPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNNzQuNSAwSDYzLjhsMy42IDMuNWMuNy43LjcgMS45IDAgMi43LS43LjctMS45LjctMi42IDBMNTguOSAwSDUzbDE0LjUgMTMuOWMuNy43LjcgMS45IDAgMi43LS43LjctMS45LjctMi42IDBMNDkgMGgtNi44bDI1LjMgMjQuM2MuNy43LjcgMS45IDAgMi43LS43LjctMS45LjctMi42IDBMMzkgMGgtNy43bDM2LjEgMzQuN2MuNy43LjcgMS45IDAgMi42cy0xLjkuNy0yLjYgMEwyOSAwYy0zLjUuNC02LjMgMy40LTYuMyA3djQ0LjdoMTAuNmwtMy42LTMuNGMtLjctLjctLjctMS45IDAtMi42czEuOS0uNyAyLjcgMGw1LjggNmg1LjlMMjkuNyAzNy45Yy0uNy0uNy0uNy0xLjkgMC0yLjcuNy0uNyAxLjktLjcgMi43IDBsMTUuOCAxNi40SDU1TDI5LjggMjcuNGMtLjctLjctLjctMS45IDAtMi43LjctLjcgMS45LS43IDIuNyAwbDI1LjggMjYuOEg2NkwyOS45IDE2LjljLS43LS43LS43LTEuOSAwLTIuNnMxLjktLjcgMi43IDBsMzUuNyAzNy4yYzMuNS0uMyA2LjMtMy4zIDYuMy03VjB6IiBmaWxsPSIjRjhBRDAwIi8+PC9zdmc+" alt="NGR Team" />
  </h4>
</div>

<div align="center">

![Python image](docs/images/logo.svg)
</div>

<div align="center"> <sub> Ascii svg art by <a href="https://GitHub.com/martinthomson/aasvg">aasvg</a>. </sub> </div>

<!-- markdownlint-enable MD033 -->

## Description

**Python container image** - —ç—Ç–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ª–µ–≥–∫–æ–≤–µ—Å–Ω–æ–π —Å–±–æ—Ä–∫–∏ –Ø–ü Python –Ω–∞ –±–∞–∑–µ Astra Linux

–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å –∫ –Ω–∞—à–∏–º —Å–æ—Ü–∏–∞–ª—å–Ω—ã–º —Å–µ—Ç—è–º:

<!-- markdownlint-disable MD033 -->

<div class="badges-row-public">
  <h4 align="center">
    <a href="https://t.me/NGR_Softlab">
      <img src="https://shields.io/badge/ngr-telegram-blue?logo=telegram&style=for-the-badge" alt="NGR Social Telegram" height="40" />
    </a>
    &emsp; &emsp; &emsp;
    <a href="https://www.ngrsoftlab.ru/?utm_source=tg&utm_medium=start" >
      <img src="https://shields.io/badge/ngr-web--page-yellow?style=for-the-badge&logo=data:image/svg%2bxml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGZpbGw9Im5vbmUiIHZpZXdCb3g9IjIyLjcgMCA1MS45IDUxLjciPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNNzQuNSAwSDYzLjhsMy42IDMuNWMuNy43LjcgMS45IDAgMi43LS43LjctMS45LjctMi42IDBMNTguOSAwSDUzbDE0LjUgMTMuOWMuNy43LjcgMS45IDAgMi43LS43LjctMS45LjctMi42IDBMNDkgMGgtNi44bDI1LjMgMjQuM2MuNy43LjcgMS45IDAgMi43LS43LjctMS45LjctMi42IDBMMzkgMGgtNy43bDM2LjEgMzQuN2MuNy43LjcgMS45IDAgMi42cy0xLjkuNy0yLjYgMEwyOSAwYy0zLjUuNC02LjMgMy40LTYuMyA3djQ0LjdoMTAuNmwtMy42LTMuNGMtLjctLjctLjctMS45IDAtMi42czEuOS0uNyAyLjcgMGw1LjggNmg1LjlMMjkuNyAzNy45Yy0uNy0uNy0uNy0xLjkgMC0yLjcuNy0uNyAxLjktLjcgMi43IDBsMTUuOCAxNi40SDU1TDI5LjggMjcuNGMtLjctLjctLjctMS45IDAtMi43LjctLjcgMS45LS43IDIuNyAwbDI1LjggMjYuOEg2NkwyOS45IDE2LjljLS43LS43LS43LTEuOSAwLTIuNnMxLjktLjcgMi43IDBsMzUuNyAzNy4yYzMuNS0uMyA2LjMtMy4zIDYuMy03VjB6IiBmaWxsPSIjRjhBRDAwIi8+PC9zdmc+" alt="NGR Social Media" height="40" />
    </a>
  </h4>
</div>

<!-- markdownlint-enable MD033 -->

## Contents

- [Python](#python)
  - [Description](#description)
  - [Contents](#contents)
  - [Requirements](#requirements)
  - [Supported Technologies](#supported-technologies)
  - [What it is](#what-it-is)
  - [How to work with](#how-to-work-with)
    - [Container variables](#container-variables)
    - [Extra pip and Python args](#extra-pip-and-python-args)
    - [Advanced environment](#advanced-environment)
  - [How to use this image](#how-to-use-this-image)
  - [How to test local](#how-to-test-local)
  - [Scratch](#scratch)
  - [Miscellaneous](#miscellaneous)
    - [Cya!](#cya)

## [Requirements](#contents)

- Docker >= 28.1.1 (–≤–æ–∑–º–æ–∂–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –≤–µ—Ä—Å–∏—è—Ö, –Ω–æ –º—ã –Ω–µ –º–æ–∂–µ–º —ç—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å)

## [Supported Technologies](#contents)

|                                                 OS                                                  |                                                 Python                                                  | Status             |
| :-------------------------------------------------------------------------------------------------: | :-----------------------------------------------------------------------------------------------------: | :----------------- |
| ![Astra 1.7](https://img.shields.io/badge/Astra-1.7.x-00ADD8?style=flat&logo=astra&logoColor=white) |  ![Python 3.7](https://img.shields.io/badge/Python-3.7-3776AB?style=flat&logo=python&logoColor=ffdd54)  | ‚úÖ Fully supported |
| ![Astra 1.8](https://img.shields.io/badge/Astra-1.8.x-00ADD8?style=flat&logo=astra&logoColor=white) | ![Python 3.11](https://img.shields.io/badge/Python-3.11-3776AB?style=flat&logo=python&logoColor=ffdd54) | ‚úÖ Fully supported |

<!-- markdownlint-disable MD033 -->
<div align="center"> <sub> –¢–∞–±–ª–∏—Ü–∞ 1. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –û–°-—ã. </sub> </div>
<p>&nbsp;</p>
<!-- markdownlint-enable MD033 -->

## [What it is](#contents)

–≠—Ç–æ—Ç –æ–±—Ä–∞–∑ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å—Ä–µ–¥—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è Python –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞. –û–Ω –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –Ω–∞ Python –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ä–µ–¥–µ. –û–±—Ä–∞–∑ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É Python –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π. –û–±—Ä–∞–∑ –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ—Ç–µ—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –û–° Astra Linux

## [How to work with](#contents)

–î–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å [pre-commit](https://pre-commit.com/) –∏ —Ö—É–∫–∏

```console
$ pip install pre-commit
$ pre-commit --version

pre-commit 4.2.0

$ pre-commit install

pre-commit installed at .git/hooks/pre-commit
pre-commit installed at .git/hooks/commit-msg
pre-commit installed at .git/hooks/pre-push
```

> [!warning]
> –ß—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–≤–æ–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å –∫–æ–º–∞–Ω–¥–æ–π `pre-commit run --all-files`.
> –ß—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –∑–∞–¥–∞—á—É, –≤–æ—Å–ø–æ–ª—å–∑—É–µ—Ç–µ—Å—å –∫–æ–º–∞–Ω–¥–æ–π `pre-commit run <target> --all-files`.
> –ï—Å–ª–∏ –í—ã –ø–æ–Ω–∏–º–∞–µ—Ç–µ —á—Ç–æ —Ç–≤–æ—Ä–∏—Ç–µ –∏ —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É `pre-commit`-–æ–º –≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å `--no-verify`, –ø—Ä–∏–º–µ—Ä `git commit -m "–î–æ–±–∞–≤–∏–ª –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ –Ω–µ —Ö–æ—á—É –ø—Ä–æ–≤–µ—Ä–∫–∏" --no-verify`

–°—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–æ—Å–æ–±–æ–≤ –∫–∞–∫ –º–æ–∂–Ω–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å–æ —Å–±–æ—Ä–∫–æ–π –æ–±—Ä–∞–∑–∞. –ë–ª–∞–≥–æ–¥–∞—Ä—è —Å–∫—Ä–∏–ø—Ç—É[^2] –º–æ–∂–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å 3 —Å–ø–æ—Å–æ–±–∞ –ø–µ—Ä–µ–¥–∞—á–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –≤ `Dockerfile`:

1. –ü–µ—Ä–µ–¥–∞—á–∞ '–ø—Ä–∏–º–µ—Ä–Ω–æ–π' –≤–µ—Ä—Å–∏–∏. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω–æ–π —Å—Ç—Ä–æ–∫–∏, —Å–∫—Ä–∏–ø—Ç [–ø–æ–ø—ã—Ç–∞–µ—Ç—Å—è –Ω–∞–π—Ç–∏](scripts/python-install-approximately.sh#L74-80) —Ç–æ—á–Ω—É—é –≤–µ—Ä—Å–∏–∏, –µ—Å–ª–∏ —Ç–∞–∫–æ–≤–æ–π –Ω–µ—Ç, —Ç–æ –±—É–¥–µ—Ç –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∞ –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞

    ```console
    ## Export Python version for 1.7.5
    $ export PYTHON_VERSION='3.7-astra1.7.5-slim'

    ## Python build utils image: 126MB
    docker build \
      --progress=plain \
      --build-arg python_identity=3.7 \
      --build-arg image_version=1.7.5-slim \
      -t python:"${PYTHON_VERSION}" \
      .

    .. build ...
    ```

2. –ü–µ—Ä–µ–¥–∞—á–∞ —Ç–æ—á–Ω–æ–π –≤–µ—Ä—Å–∏–∏

    ```console
    ## Export Python version for 1.8.2
    $ export PYTHON_VERSION='3.11-astra1.8.2-slim'

    ## Python build utils image: 141MB
    docker build \
      --progress=plain \
      --build-arg python_identity=3.11.2-1+b3 \
      --build-arg image_version=1.8.2-slim \
      -t python:"${PYTHON_VERSION}" \
      .

    .. build ...
    ```

3. –ü–µ—Ä–µ–¥–∞—á–∞ —Å—Å—ã–ª–∫–∏, –Ω–∞ –∑–∞—Ä–∞–Ω–µ–µ —Å–æ–±—Ä–∞–Ω–Ω—ã–π –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤ Python

    ```console
    ## Export Python version for 1.8.2
    $ export PYTHON_VERSION='3.13-astra1.8.2-slim'

    ## Python build utils image: 198MB
    docker build \
      --progress=plain \
      --build-arg python_identity=https://example-registry.com/repository/python/python-v3.13.2-linux-amd64.tar.gz \
      --build-arg image_version=1.8.2-slim \
      -t python:"${PYTHON_VERSION}" \
      .

    .. build ...
    ```

> [!tip]
> –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤–µ—Ä—Å–∏–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -
> `apt show python3-minimal`,
> `apt-cache policy python3-minimal`,
> `apt-cache show python3-minimal`

–†–∞–±–æ—Ç–∞ —Å –ø—Ä–æ–∫—Å–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è–º–∏. –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Ç–æ–∂–µ —è–≤–ª—è–µ—Ç—Å—è '–ø–ª–∞–≤–∞—é—â–µ–π' —Ç.–µ. –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–π –Ω–∞–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –í–∞—à–µ–≥–æ —É–¥–æ–±—Å—Ç–≤–∞:

1. –ï—Å–ª–∏ –í–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ –∏/–∏–ª–∏ –∏–Ω–¥–µ–∫—Å –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –∏–Ω–¥–µ–∫—Å–∞ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è –ø—Ä–æ–∫—Å–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è - —Ä–∞–∑—Ä–µ—à–∞–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–æ–∫—Å–∏

    ```console
    ## Export Python version for 1.8.2
    $ export PYTHON_VERSION='3.11-astra1.8.2-slim'

    docker build \
      --progress=plain \
      --build-arg image_registry=example-container.registry.com/ \
      --build-arg pip_registry_index=https://example-registry.com/repository/python-cache-repostory/pypi \
      --build-arg pip_registry_url=https://example-registry.com/repository/python-cache-repostory/simple \
      --build-arg pip_trusted_host=example-registry.com \
      --build-arg python_identity=3.11 \
      --build-arg image_version=1.8.2-slim \
      -t python:"${PYTHON_VERSION}" \
      .

    .. build ...
    ```

2. –ï—Å–ª–∏ `index` –∏ `index-url` –∏–º–µ—é—Ç –æ–¥–∏–Ω '–∏—Å—Ç–æ—á–Ω–∏–∫', —Ç–æ –≤–æ–∑–º–æ–∂–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–±–æ–±—â–µ–Ω–∏—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

    ```console
    ## Export Python version for 1.8.2
    $ export PYTHON_VERSION='3.11-astra1.8.2-slim'

    docker build \
      --progress=plain \
      --build-arg image_registry=example-container.registry.com/ \
      --build-arg package_registry_proxy=https://example-registry.com/repository/python-cache-repostory \
      --build-arg package_registry_trust_host=example-registry.com \
      --build-arg python_identity=3.11 \
      --build-arg image_version=1.8.2-slim \
      -t python:"${PYTHON_VERSION}" \
      .

    .. build ...
    ```

### [Container variables](#contents)

| –ò–º—è                  | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |  –¢–∏–ø   |                                                                                                –û–ø–∏—Å–∞–Ω–∏–µ |
| :------------------- | :-------------------: | :----: | ------------------------------------------------------------------------------------------------------: |
| `image_name`         |         astra         | string |                                                                                             –ò–º—è –æ–±—Ä–∞–∑–∞. |
| `image_registry`     |          ''           | string |                                                                            –ê–¥—Ä–µ—Å –¥–æ —Ä–µ–µ—Å—Ç—Ä–∞ –æ–±—Ä–∞–∑–∞[^1]. |
| `image_version`      |      1.8.2-slim       | string |                                                                                          –í–µ—Ä—Å–∏—è –æ–±—Ä–∞–∑–∞. |
| `pip_registry_index` |          ''           | string |                 –ò–º—è –∏–Ω–¥–µ–∫—Å–∞, –∫–æ—Ç–æ—Ä—ã–π `pip` –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–∑ —Å–ø–∏—Å–∫–∞ –∑–∞—Ä–∞–Ω–µ–µ –∑–∞–¥–∞–Ω–Ω—ã—Ö –≤ –∫–æ–Ω—Ñ–∏–≥–µ[^3]. |
| `pip_registry_url`   |          ''           | string |             –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –ø–∞–∫–µ—Ç–æ–≤, –æ—Ç–∫—É–¥–∞ `pip` –±—É–¥–µ—Ç —Å–∫–∞—á–∏–≤–∞—Ç—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é[^3]. |
| `pip_trusted_host`   |          ''           | string | –î–æ–±–∞–≤–ª—è–µ—Ç —Ö–æ—Å—Ç –≤ —Å–ø–∏—Å–æ–∫ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö, —á—Ç–æ–±—ã `pip` –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–ª SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ –Ω–µ–º—É[^3]. |
| `python_identity`    |         3.11          | string |                                                                            –û–∂–∏–¥–∞–µ–º–∞—è –≤–µ—Ä—Å–∏—è Python[^2]. |

<!-- markdownlint-disable MD033 -->
<div align="center"> <sub> –¢–∞–±–ª–∏—Ü–∞ 2. –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –¥–ª—è —Å–±–æ—Ä–∫–∏ –æ–±—Ä–∞–∑–∞. </sub> </div>
<p>&nbsp;</p>
<!-- markdownlint-enable MD033 -->

### [Extra pip and Python args](#contents)

–í–æ–≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã —Å–±–æ—Ä–∫–∏, `pip` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç [`env-wrapper`](scripts/pip-env.sh) –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–≥–∞–µ—Ç —É—Å–∫–æ—Ä–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤. –ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ —Å –∫—Ä–∞—Ç–∫–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –ú–û–ì–£–¢ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤–æ –≤—Ä–µ–º—è —Å–±–æ—Ä–∫–∏ –ò —Ç–∞–∫–∂–µ –≥–ª–æ–±–∞–ª—å–Ω–æ –æ–±—ä—è–≤–ª—è—Ç—å—Å—è –≤ –∫–æ–Ω–µ—á–Ω–æ–º(—Ü–µ–ª–µ–≤–æ–º) –æ–±—Ä–∞–∑–µ. –í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ –∏–ª–∏ –∏–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —Å–±–æ—Ä–∫–∞–º–∏, –µ—Å–ª–∏ –ø–æ–Ω–∏–º–∞–µ—Ç–µ —á—Ç–æ —Ç–≤–æ—Ä–∏—Ç–µ

| –ù–∞–∑–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π                                |              –ó–Ω–∞—á–µ–Ω–∏–µ               | –ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –ø—Ä–∏ —Å–±–æ—Ä–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞                                                  | –ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –≤ `scratch`-–æ–±—Ä–∞–∑–µ                                         | –ö—Ä–∞—Ç–∫–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π                                                                                |
| :------------------------------------------------- | :---------------------------------: | :----------------------------------------------------------------------------------- | :----------------------------------------------------------------------- | :----------------------------------------------------------------------------------------------------------- |
| `PIP_BREAK_SYSTEM_PACKAGES=1`                      |              –í–∫–ª—é—á–µ–Ω–æ               | –ü–æ–∑–≤–æ–ª—è–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ø–∞–∫–µ—Ç—ã —á–µ—Ä–µ–∑ `pip`                                     | –û–±—ã—á–Ω–æ –Ω–µ –Ω—É–∂–Ω–∞                                                          | –ü–æ–∑–≤–æ–ª—è–µ—Ç `pip` –∏–∑–º–µ–Ω—è—Ç—å –ø–∞–∫–µ—Ç—ã, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–º –ø–∞–∫–µ—Ç–Ω—ã–º –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, `apt`, `apk`)        |
| `PIP_DISABLE_PIP_VERSION_CHECK=1`                  |              –í–∫–ª—é—á–µ–Ω–æ               | –û—Ç–∫–ª—é—á–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π `pip` ‚Äî —É—Å–∫–æ—Ä—è–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫—É –∏ –∏–∑–±–µ–≥–∞–µ—Ç —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ | –ü–æ–ª–µ–∑–Ω–æ, –µ—Å–ª–∏ –æ–±—Ä–∞–∑ –Ω–µ –∏–º–µ–µ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –∏–ª–∏ –Ω—É–∂–Ω–æ –∏–∑–±–µ–∂–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π | –û—Ç–∫–ª—é—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Ç–æ–º, —á—Ç–æ –µ—Å—Ç—å –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è `pip`                                                     |
| `PIP_NO_CACHE_DIR=1`                               |              –í–∫–ª—é—á–µ–Ω–æ               | –£—Å–∫–æ—Ä—è–µ—Ç —Å–±–æ—Ä–∫—É –∏ —ç–∫–æ–Ω–æ–º–∏—Ç –º–µ—Å—Ç–æ ‚Äî –æ—Ç–∫–ª—é—á–∞–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤                     | –ú–æ–∂–µ—Ç —Å—ç–∫–æ–Ω–æ–º–∏—Ç—å –º–µ—Å—Ç–æ                                                   | –û—Ç–∫–ª—é—á–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –∫—ç—à–∞ `pip` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `~/.cache/pip`)                                                  |
| `PIP_NO_COMPILE=1`                                 |              –í–∫–ª—é—á–µ–Ω–æ               | –£—Å–∫–æ—Ä—è–µ—Ç —Å–±–æ—Ä–∫—É ‚Äî –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç `.pyc` —Ñ–∞–π–ª—ã                                         | –£–º–µ–Ω—å—à–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–º–ø–æ—Ä—Ç–∞ –º–æ–¥—É–ª–µ–π                             | –û—Ç–∫–ª—é—á–∞–µ—Ç –∫–æ–º–ø–∏–ª—è—Ü–∏—é `.py` –≤ `.pyc`, —ç–∫–æ–Ω–æ–º—è –≤—Ä–µ–º—è –∏ –º–µ—Å—Ç–æ –Ω–∞ —ç—Ç–∞–ø–µ —Å–±–æ—Ä–∫–∏                                   |
| `PIP_ROOT_USER_ACTION=ignore`                      |               ignore                | –ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å `pip` –æ—Ç root –±–µ–∑ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π                                 | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –µ—Å–ª–∏ –æ–±—Ä–∞–∑ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç `root`                              | –û—Ç–∫–ª—é—á–∞–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ `pip` –æ—Ç –∏–º–µ–Ω–∏ `root`                                                   |
| `PYTHONDONTWRITEBYTECODE=1`                        |              –í–∫–ª—é—á–µ–Ω–æ               | –≠–∫–æ–Ω–æ–º–∏—Ç –º–µ—Å—Ç–æ ‚Äî –Ω–µ —Å–æ–∑–¥–∞—ë—Ç `.pyc` —Ñ–∞–π–ª–æ–≤                                            | –£—Ö—É–¥—à–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å                                              | Python –Ω–µ –±—É–¥–µ—Ç –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –±–∞–π—Ç-–∫–æ–¥—ã (`__pycache__`, `.pyc`), —ç–∫–æ–Ω–æ–º—è –º–µ—Å—Ç–æ –∏ –≤—Ä–µ–º—è         |
| `PYTHONWARNINGS="ignore:Unverified HTTPS request"` | `"ignore:Unverified HTTPS request"` | –ü–æ–ª–µ–∑–Ω–æ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –∏–ª–∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤        | –ú–æ–∂–µ—Ç –ø–æ–Ω–∞–¥–æ–±–∏—Ç—å—Å—è, –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `pip` –∏–ª–∏ `python` —Å HTTP(S)       | –ü–æ–¥–∞–≤–ª—è–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –Ω–µ–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö HTTPS-–∑–∞–ø—Ä–æ—Å–∞—Ö (—á–∞—Å—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–º–∏ SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏) |

<!-- markdownlint-disable MD033 -->
<div align="center"> <sub> –¢–∞–±–ª–∏—Ü–∞ 3. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è PIP –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –æ–±—Ä–∞–∑–∞–º–∏ –∏ –∏—Ö –≤–ª–∏—è–Ω–∏–µ –Ω–∞ —Å–±–æ—Ä–∫—É/—Ä–∞–±–æ—Ç—É –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ. </sub> </div>
<p>&nbsp;</p>
<!-- markdownlint-enable MD033 -->

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± –æ—á–∏—Å—Ç–∫–∏ –∫–µ—à–∞, —á—Ç–æ–±—ã —É–º–µ–Ω—å—à–∏—Ç—å —Ä–∞–∑–º–µ—Ä –æ–±—Ä–∞–∑–∞:

```Dockerfile
FROM python:3.11-astra1.8.2-slim

WORKDIR /app

COPY . .

RUN pip install --no-cache-dir -r requirements.txt

CMD ["python", "app.py"]
```

### [Advanced environment](#contents)

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —Å–±–æ—Ä–∫–∏ –±–∞–∑–æ–≤–æ–≥–æ –æ–±—Ä–∞–∑–∞ –∏–¥—ë—Ç –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ `/etc/environment`. –í –Ω—ë–º –æ—Ç—Ä–∞–∂–µ–Ω—ã –æ–±—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ —Å–±–æ—Ä–æ—á–Ω—ã—Ö –æ–±—Ä–∞–∑–∞—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

1. –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è –æ–±—Ä–∞–∑–∞ `3.13` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –∏–∑ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –∏ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ Python

    ```console
    $ cat /etc/environment

    PYTHON_REVISION=Installed-from-URL
    BEGIN_BUILD_IN_EPOCH=1746194532
    PYTHON_LIB_PATH=/usr/local/lib/python3.13
    PYTHON_SITE_PACKAGES=/usr/local/lib/python3.13/site-packages
    PYTHON_MAJOR_MINOR_PATCH_VERSION=3.13.2
    PYTHON_MAJOR_MINOR_VERSION=3.13
    ```

2. –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è –æ–±—Ä–∞–∑–∞ `3.11` –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ Astra Linux

    ```console
    $ cat /etc/environment

    PYTHON_REVISION=3.11.2-1+b3
    BEGIN_BUILD_IN_EPOCH=1746191721
    PYTHON_LIB_PATH=/usr/lib/python3.11
    PYTHON_SITE_PACKAGES=/usr/local/lib/python3.11/dist-packages
    PYTHON_MAJOR_MINOR_PATCH_VERSION=3.11.2
    PYTHON_MAJOR_MINOR_VERSION=3.11
    ```

3. –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è –æ–±—Ä–∞–∑–∞ `3.7` –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ Astra Linux

    ```console
    $ cat /etc/environment

    PYTHON_REVISION=3.7.3-1
    BEGIN_BUILD_IN_EPOCH=1746278986
    PYTHON_LIB_PATH=/usr/lib/python3.7
    PYTHON_SITE_PACKAGES=/usr/local/lib/python3.7/dist-packages
    PYTHON_MAJOR_MINOR_PATCH_VERSION=3.7.3
    PYTHON_MAJOR_MINOR_VERSION=3.7
    ```

## [How to use this image](#contents)

–î–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–π –æ–±—Ä–∞–∑, —Å–æ–∑–¥–∞–π—Ç–µ `Dockerfile` —Å –ø—Ä–æ—Å—Ç—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏

```Dockerfile
FROM python:3.11-astra1.8.2-slim

WORKDIR /usr/src/app

COPY requirements.txt ./
RUN pip install --no-cache-dir -r requirements.txt

COPY . .

CMD [ "python", "./your-daemon-or-script.py" ]
```

–ó–∞—Ç–µ–º —Å–æ–±–µ—Ä–∏—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –æ–±—Ä–∞–∑

```console
$ docker build -t my-python-app .
$ docker run -it --rm --name my-running-app my-python-app

...run logic...
```

–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å –æ–¥–∏–Ω–æ—á–Ω—ã–π —Ñ–∞–π–ª Python-–∞, –í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É

```console
$ docker run -it --rm --name my-running-script -v "$PWD":/usr/src/myapp -w /usr/src/myapp python:3.11-astra1.8.2-slim python your-daemon-or-script.py

...run logic...
```

## [How to test local](#contents)

–ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç:

```shell
docker run --rm python:3.11-astra1.8.2-slim python -c "print('Hello from Python')"
```

## [Scratch](#contents)

–î–∞–Ω–Ω—ã–π —Ä–∞–∑–¥–µ–ª –±—É–¥–µ—Ç –æ–±–µ—Å–ø–µ—á–∏–≤–∞—Ç—å –∫—Ä–∞—Ç–∫–∏–µ –≤–≤–æ–¥–Ω—ã–µ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –í—ã –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º –º–æ–≥–ª–∞ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–∏ `Scratch` —Å–±–æ—Ä–∫–∏, –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ —Å–ª–æ–∂–Ω–æ—Å–æ—Å—Ç–∞–≤–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞. –í—Å–µ, —á—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è, —Ç–∞–∫–∂–µ –ø–æ–¥–∫—Ä–µ–ø–ª–µ–Ω–æ –∏ –≤—Å–µ–º–∏ –∑–∞–¥–µ–π—Å—Ç–≤–æ–≤–∞–Ω–Ω—ã–º–∏ —Å–∫—Ä–∏–ø—Ç–∞–º–∏ [—Å–±–æ—Ä–æ—á–Ω—ã–º–∏](scripts/) –∏–ª–∏ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –¥–ª—è [—Å–±–æ—Ä–∫–∏](scratch/) —á–µ—Ä–µ–∑ `scratch`. –í—Å–µ –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏ –ø–æ–¥–µ–ª–µ–Ω—ã –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ '—à–∞–≥–æ–≤' –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö –±—É–¥—É—Ç –¥–∞–Ω—ã –∫—Ä–∞—Ç–∫–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏:

1. –ü–µ—Ä–≤—ã–º —ç—Ç–∞–ø–æ–º –∏–¥—ë—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è, —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∫–∞–∫ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö, —Ç–∞–∫ –∏ `pip`

    ```Dockerfile
    ## Install base project deps
    # hadolint ignore=DL3042
    RUN \
        --mount=type=bind,source=./scripts,target=/usr/local/sbin,readonly \
        --mount=type=bind,source=./requirements.txt,target=/requirements.txt,readonly \
        apt-install.sh \
            libldap2-dev \
            libpq-dev \
            libsasl2-dev \
            libssl-dev \
            iputils-ping \
            python3-dev \
            build-essential \
            ldap-utils \
            libfreetype6-dev \
            libpq-dev \
            libidn2-dev \
    ## Set corporative proxy
        && python-set-proxy.sh \
    ## Install project components
        && pip-env.sh pip install -r /requirements.txt \
        && python-rm-cache.sh "${PYTHON_VENV_SITE_PACKAGES}" \
    ## Clean cache
        && apt-clean.sh
    ```

2. –í—Ç–æ—Ä–æ–π —ç—Ç–∞–ø –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –∫–æ–º–ø–∏–ª—è—Ü–∏—é –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä–∞ Python, **–±–µ–∑ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤**. –ü–æ—è—Å–Ω–µ–Ω–∏–µ: –∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤, –º–æ–∂–µ—Ç –≥—Ä–æ–∑–∏—Ç—å —Ç–µ–º, —á—Ç–æ –ø—Ä–æ–µ–∫—Ç –±—É–¥–µ—Ç –Ω–µ –ø—Ä–∏–≥–æ–¥–µ–Ω, —Ç.–∫. –ø–æ–º–∏–º–æ `.py` –º–æ–≥—É—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∏ `.c` —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –∏ –ø—Ä–∏ –∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–∏ —Ç–∞–∫–æ–π '—Å–æ–ª—è–Ω–∫–∏' –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ø—Ä–æ—Å—Ç—É –ø–µ—Ä–µ—Å—Ç–∞–Ω–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å, —Ç.–∫. –Ω–µ —Å–º–æ–∂–µ—Ç –Ω–∞–π—Ç–∏ –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–∏ —Å –¥—Ä—É–≥–∏–º–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º–∏. –ü—Ä–∏–º–µ—Ä —Ç–∞–∫–∏—Ö —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç '—Å–ª–æ–º–∞—Ç—å' —Å–±–æ—Ä–∫—É: `numpy`, `pandas`, `cryptography` –∏ —Ç.–¥.

    ```Dockerfile
    ## Change path to work dir
    WORKDIR /opt

    ## Compile and cleanup cpython
    ## We not compile VENV because this packages include C and multiple another extension
    # hadolint ignore=DL3003,SC1091
    RUN \
        --mount=type=bind,source=./scripts,target=/usr/local/sbin,readonly \
    ## Get build info from env file
        source /etc/environment \
    ## Change path to main python
        && cd "${PYTHON_LIB_PATH}" \
    ## Compile root python
        && python-compile.sh \
    ## Reduce package directory size
        && PYTHON_VENV_SITE_PACKAGES="$(python3 -c 'import site;print(site.getsitepackages()[0])')" \
        && python-remove-unwanted.sh "${PYTHON_VENV_SITE_PACKAGES}" \
        && find "${PYTHON_VENV_PATH}" -iname '*.exe' -ls -delete
    ```

3. –¢—Ä–µ—Ç—å–∏–º —ç—Ç–∞–ø–æ–º —Ñ–æ—Ä–º–∏—Ä—É–µ–º –±–∞–∑–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞ –≤ `Scratch`

    ```Dockerfile
    ## Install build components
    RUN \
    ## Directory structure and permissions
        mkdir -p \
            /base/bin \
            /base/tmp \
            /base/var/tmp \
            /base/etc/ssl \
            /base/sbin \
            /base/root \
            /base/usr/lib/ \
            "/base${PYTHON_VENV_PATH%/*}" \
            /base/usr/src/app \
        && chmod 700 /base/root \
        && chown root:root /base/root \
        && chmod 1777 /base/tmp /base/var/tmp \
    ## UID and GID
        && echo 'root:x:0:' > /base/etc/group \
        && echo 'root:x:0:0:root:/root:/sbin/nologin' > /base/etc/passwd \
    ## Nologin binary
        && echo 'int main() { return 1; }' > nologin.c \
        && gcc -Os -no-pie -static -std=gnu99 -s -Wall -Werror -o /base/sbin/nologin nologin.c
    ```

4. –ß–µ—Ç–≤–µ—Ä—Ç—ã–º —ç—Ç–∞–ø–æ–º –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–µ—Ä–µ–Ω–æ—Å –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

    ```Dockerfile
    ## Copy depended binary
    # hadolint ignore=SC1091
    RUN \
        --mount=type=bind,source=./scripts,target=/usr/local/sbin,readonly \
    ## Get python version
        source /etc/environment \
    ## Execute transfer ldd /bin
        && copy-bin.sh \
            --prefix "/base" \
            --ldd "/bin/dumb-init" \
            --links "/bin:/sbin:/usr/bin:/usr/sbin" \
    ## Execute transfer ldd /usr/bin
        && copy-bin.sh \
            --prefix "/base" \
            --ldd "/usr/bin/python${PYTHON_MAJOR_MINOR_VERSION}" \
            --links "/bin:/sbin:/usr/bin:/usr/sbin" \
    ## Copy compiled python venv
        && cp -R "${PYTHON_VENV_PATH}" "/base${PYTHON_VENV_PATH%/*}" \
    ## Copy compiled python
        && cp -R "${PYTHON_LIB_PATH}" "/base/usr/lib/" \
    ## Copy shared objects
        && copy-lib.sh /base/lib/x86_64-linux-gnu/ \
    ## Can read host files for FQDN
            /usr/lib/x86_64-linux-gnu/libnss_files \
    ## PYTHON critical shared objects
            /usr/lib/libgost \
            /usr/lib/x86_64-linux-gnu/libquadmath \
            ... list of libs ...
    ## Cleanup from deduplicates transfer directory
        && dedup-clean.sh /base/usr/
    ```

5. –ü—è—Ç—ã–π - —ç—Ç–æ –ø–æ–±–æ—á–Ω—ã–π —ç—Ç–∞–ø, –∑–¥–µ—Å—å –º–æ–∂–Ω–æ —Ä–∞–∑–¥–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø—Ä–∞–≤–∞ –Ω–∞ —Ä–∞–±–æ—á–∏–π –ø—É—Ç—å –∏ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ä–∞–±–æ—á–∏–µ —Ñ–∞–π–ª—ã

    ```Dockerfile
    ## Transfer base project component
    COPY lib/ /base/usr/src/app/lib/

    ## Remove extra write permissions
    RUN \
        find /base/usr/src/app -type f -print0 | xargs -0 chmod 644 \
        && find /base/usr/src/app -type d -print0 | xargs -0 chmod 755
    ```

6. –®–µ—Å—Ç–æ–π —ç—Ç–∞–ø - —ç—Ç–æ —Å–ª–æ–π –æ—Ç–ª–∞–¥–∫–∏. –ù–µ–æ–±—Ö–æ–¥–∏–º–∞—è –º–µ—Ä–∞, –¥–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –≤ —Å–ª—É—á–∞–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫ –∏–ª–∏ –æ—à–∏–±–æ–∫, –º—ã –º–æ–≥–ª–∏ —Å–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑ —Å `docker build --target debug-stage` –∏ –≤—ã–≤–µ—Å—Ç–∏ –æ—Ç–ª–∞–¥–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—ã–∑–æ–≤–∞—Ö –ø—Ä–∏ –ø–æ–º–æ—â–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, [`wrapper-lib.sh`](scratch/wrapper-lib.sh)

    ```Dockerfile
    FROM base-stage AS debug-stage

    RUN \
        --mount=type=bind,source=./scripts,target=/usr/local/sbin,readonly \
    ## Install debug tools
        apt-install.sh \
            strace \
            ltrace \
            gdb \
            tcpdump \
            procps \
            net-tools \
            jq \
            xmlstarlet \
    ## Clean cache
        && apt-clean.sh

    ## Set work directory
    WORKDIR /usr/src/app

    ## Transfer base project component
    COPY lib/ lib/
    ```

7. –°–µ–¥—å–º–æ–π —ç—Ç–∞–ø - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å–æ `Scratch` –æ–±—Ä–∞–∑–æ–º. –¢.–∫. —Ç–∞–º –Ω–µ—Ç –Ω–∏—á–µ–≥–æ, —Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–∑–∞–±–æ—Ç–∏—Ç—å—Å—è –æ —Ç–æ–º, —á—Ç–æ–±—ã —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø—É—Ç–∏, –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ. –¢–∞–∫–∂–µ, —Ç.–∫. —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤ –±—ã–ª–∞ –±–µ–∑ `.pyc` —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è, —Ç–æ –Ω–∞ –Ω–∞—à–∏ –ø–ª–µ—á–∏ –ª–æ–∂–∏—Ç—Å—è —Ç–∞–∫–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è –∫–∞–∫ –ø—Ä–æ–≥—Ä–µ–≤ –∫–µ—à–∞. –ü–æ–ª—å–∑—É—è—Å—å –Ω–µ–±–æ–ª—å—à–æ–π —Ö–∏—Ç—Ä–æ—Å—Ç—å—é, –º—ã –≤—Ä–µ–º–µ–Ω–Ω–æ –º–æ–Ω—Ç–∏—Ä—É–µ–º `bash` –∫–∞–∫ `sh`, —á—Ç–æ–±—ã –æ–±–æ–π—Ç–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º `Docker` —Å—Å—ã–ª–∞–µ—Ç—Å—è, –±–µ–∑ —è–≤–Ω–æ–≥–æ —É–∫–∞–∑–∞–Ω–∏—è –Ω–∞ –æ–±–æ–ª–æ—á–∫—É —á–µ—Ä–µ–∑ `SHELL`, –Ω–∞ `/bin/sh` –∏ –≤—ã–ø–æ–ª–Ω—è–µ–º –∂–µ–ª–∞–µ–º—ã–π —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥

    ```Dockerfile
    # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
    #                        Final image                          #
    #              Third stage, compact optimize layer            #
    # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
    FROM scratch

    COPY --from=base-stage /base/ /

    ENV PYTHON_VENV_PATH='/usr/local/lib/python-venv'

    ## Add venv into path
    ENV \
        PATH="${PYTHON_VENV_PATH}/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin" \
        LANG=C.UTF-8

    ## Set work directory
    WORKDIR /usr/src/app

    ## Little trick, we just mounting shell to provide cache warmup
    RUN \
        --mount=type=bind,from=base-stage,source=/usr/bin/bash,target=/bin/sh,readonly \
        --mount=type=bind,from=base-stage,source=/usr/lib/x86_64-linux-gnu/libtinfo.so.6,target=/usr/lib/x86_64-linux-gnu/libtinfo.so.6,readonly \
        gunicorn --help \
        && netaddr --help \
        && normalizer --help \
        && f2py -h \
        && flask --help \
        && fonttools --help \
        && numpy-config --help

    ENTRYPOINT [ "dumb-init", "--" ]
    CMD [ "python3" ]
    ```

–ü–æ–ª–Ω—ã–π `Dockerfile`:

```Dockerfile
# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
#                         Base image                          #
#               First stage, prepare environment              #
# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
FROM python:3.11-astra1.8.2 AS base-stage

SHELL [ "/bin/bash", "-exo", "pipefail", "-c" ]

## Redefined DEFAULT args
ARG package_registry_proxy
ARG package_registry_trust_host

## Install base project deps
# hadolint ignore=DL3042
RUN \
    --mount=type=bind,source=./scripts,target=/usr/local/sbin,readonly \
    --mount=type=bind,source=./requirements.txt,target=/requirements.txt,readonly \
    apt-install.sh \
        libldap2-dev \
        libpq-dev \
        libsasl2-dev \
        libssl-dev \
        iputils-ping \
        python3-dev \
        build-essential \
        ldap-utils \
        libfreetype6-dev \
        libpq-dev \
        libidn2-dev \
## Set corporative proxy
    && python-set-proxy.sh \
## Install project components
    && pip-env.sh pip install -r /requirements.txt \
    && python-rm-cache.sh "${PYTHON_VENV_SITE_PACKAGES}" \
## Clean cache
    && apt-clean.sh

## Change path to work dir
WORKDIR /opt

## Compile and cleanup cpython
## We not compile VENV because this packages include C and multiple another extension
# hadolint ignore=DL3003,SC1091
RUN \
    --mount=type=bind,source=./scripts,target=/usr/local/sbin,readonly \
## Get build info from env file
    source /etc/environment \
## Change path to main python
    && cd "${PYTHON_LIB_PATH}" \
## Compile root python
    && python-compile.sh \
## Reduce package directory size
    && PYTHON_VENV_SITE_PACKAGES="$(python3 -c 'import site;print(site.getsitepackages()[0])')" \
    && python-remove-unwanted.sh "${PYTHON_VENV_SITE_PACKAGES}" \
    && find "${PYTHON_VENV_PATH}" -iname '*.exe' -ls -delete

## Install build components
RUN \
## Directory structure and permissions
    mkdir -p \
        /base/bin \
        /base/tmp \
        /base/var/tmp \
        /base/etc/ssl \
        /base/sbin \
        /base/root \
        /base/usr/lib/ \
        "/base${PYTHON_VENV_PATH%/*}" \
        /base/usr/src/app \
    && chmod 700 /base/root \
    && chown root:root /base/root \
    && chmod 1777 /base/tmp /base/var/tmp \
## UID and GID
    && echo 'root:x:0:' > /base/etc/group \
    && echo 'root:x:0:0:root:/root:/sbin/nologin' > /base/etc/passwd \
## Nologin binary
    && echo 'int main() { return 1; }' > nologin.c \
    && gcc -Os -no-pie -static -std=gnu99 -s -Wall -Werror -o /base/sbin/nologin nologin.c

## Copy depended binary
# hadolint ignore=SC1091
RUN \
    --mount=type=bind,source=./scripts,target=/usr/local/sbin,readonly \
## Get python version
    source /etc/environment \
## Execute transfer ldd /bin
    && copy-bin.sh \
        --prefix "/base" \
        --ldd "/bin/dumb-init" \
        --links "/bin:/sbin:/usr/bin:/usr/sbin" \
## Execute transfer ldd /usr/bin
    && copy-bin.sh \
        --prefix "/base" \
        --ldd "/usr/bin/python${PYTHON_MAJOR_MINOR_VERSION}" \
        --links "/bin:/sbin:/usr/bin:/usr/sbin" \
## Copy compiled python venv
    && cp -R "${PYTHON_VENV_PATH}" "/base${PYTHON_VENV_PATH%/*}" \
## Copy compiled python
    && cp -R "${PYTHON_LIB_PATH}" "/base/usr/lib/" \
## Copy shared objects
    && copy-lib.sh /base/lib/x86_64-linux-gnu/ \
## Can read host files for FQDN
        /usr/lib/x86_64-linux-gnu/libnss_files \
## PYTHON critical shared objects
        /usr/lib/libgost \
        /usr/lib/x86_64-linux-gnu/libquadmath \
        /usr/lib/x86_64-linux-gnu/libbfd-2.40-system \
        /usr/lib/x86_64-linux-gnu/libctf \
        /usr/lib/x86_64-linux-gnu/libgmp \
        /usr/lib/x86_64-linux-gnu/libjansson \
        /usr/lib/x86_64-linux-gnu/libliboqs \
        /usr/lib/x86_64-linux-gnu/liboqs \
        /usr/lib/x86_64-linux-gnu/libsframe \
        /usr/lib/x86_64-linux-gnu/libuuid \
        /usr/lib/x86_64-linux-gnu/libgcc_s \
        /usr/lib/x86_64-linux-gnu/libffi \
        /usr/lib/x86_64-linux-gnu/liblzma \
        /usr/lib/x86_64-linux-gnu/libexpat \
        /usr/lib/x86_64-linux-gnu/libbz2 \
        /usr/lib/x86_64-linux-gnu/libhogweed \
        /usr/lib/x86_64-linux-gnu/libnettle \
        /usr/lib/x86_64-linux-gnu/libtasn1 \
        /usr/lib/x86_64-linux-gnu/libunistring \
        /usr/lib/x86_64-linux-gnu/libidn2 \
        /usr/lib/x86_64-linux-gnu/libpq \
        /usr/lib/x86_64-linux-gnu/libp11-kit \
        /usr/lib/x86_64-linux-gnu/libresolv \
        /usr/lib/x86_64-linux-gnu/libkeyutils \
        /usr/lib/x86_64-linux-gnu/libgnutls \
        /usr/lib/x86_64-linux-gnu/liblber-2.5 \
        /usr/lib/x86_64-linux-gnu/libkrb5 \
        /usr/lib/x86_64-linux-gnu/libkrb5support \
        /usr/lib/x86_64-linux-gnu/libk5crypto \
        /usr/lib/x86_64-linux-gnu/libcom_err \
        /usr/lib/x86_64-linux-gnu/libzstd \
        /usr/lib/x86_64-linux-gnu/libgssapi_krb5 \
        /usr/lib/x86_64-linux-gnu/librt \
        /usr/lib/x86_64-linux-gnu/libssl \
        /usr/lib/x86_64-linux-gnu/libcrypto \
        /usr/lib/x86_64-linux-gnu/libcrypt \
        /usr/lib/x86_64-linux-gnu/libstdc++ \
        /usr/lib/x86_64-linux-gnu/libc \
        /usr/lib/x86_64-linux-gnu/libpthread \
        /usr/lib/x86_64-linux-gnu/libm \
        /usr/lib/x86_64-linux-gnu/libdl \
        /usr/lib/x86_64-linux-gnu/libz \
        /usr/lib/x86_64-linux-gnu/libldap-2.5 \
        /usr/lib/x86_64-linux-gnu/libsasl2 \
## Cleanup from deduplicates transfer directory
    && dedup-clean.sh /base/usr/

## Transfer base project component
COPY lib/ /base/usr/src/app/lib/

## Remove extra write permissions
RUN \
    find /base/usr/src/app -type f -print0 | xargs -0 chmod 644 \
    && find /base/usr/src/app -type d -print0 | xargs -0 chmod 755

# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
#                         Debug image                         #
#               Second stage, install debug tools             #
# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
FROM base-stage AS debug-stage

RUN \
    --mount=type=bind,source=./scripts,target=/usr/local/sbin,readonly \
## Install debug tools
    apt-install.sh \
        strace \
        ltrace \
        gdb \
        tcpdump \
        procps \
        net-tools \
        jq \
        xmlstarlet \
## Clean cache
    && apt-clean.sh

## Set work directory
WORKDIR /usr/src/app

## Transfer base project component
COPY lib/ lib/

# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
#                        Final image                          #
#              Third stage, compact optimize layer            #
# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
FROM scratch

COPY --from=base-stage /base/ /

## Set base label
LABEL \
    maintainer="Vladislav Avdeev" \
    organization="NGRSoftlab"

ENV PYTHON_VENV_PATH='/usr/local/lib/python-venv'

## Add venv into path
ENV \
    PATH="${PYTHON_VENV_PATH}/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin" \
    LANG=C.UTF-8

## Set work directory
WORKDIR /usr/src/app

## Little trick, we just mounting shell to provide cache warmup
RUN \
    --mount=type=bind,from=base-stage,source=/usr/bin/bash,target=/bin/sh,readonly \
    --mount=type=bind,from=base-stage,source=/usr/lib/x86_64-linux-gnu/libtinfo.so.6,target=/usr/lib/x86_64-linux-gnu/libtinfo.so.6,readonly \
    gunicorn --help \
    && netaddr --help \
    && normalizer --help \
    && f2py -h \
    && flask --help \
    && fonttools --help \
    && numpy-config --help

ENTRYPOINT [ "dumb-init", "--" ]
CMD [ "python3" ]
```

–î–æ–±–∞–≤–æ—á–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–π –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π `Scratch` –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–∞–∫–µ—Ç—ã

1. –ü–µ—Ä–≤—ã–º —ç—Ç–∞–ø–æ–º —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–∞–∫–µ—Ç –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é, –∫–æ—Ç–æ—Ä–∞—è –ø–æ—Å–ª—É–∂–∏—Ç –¥–∞–ª—å–Ω–µ–π—à–∏–º '–¥–æ–Ω–æ—Ä–æ–º' –¥–ª—è –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –∑–∞—Ä–∞–Ω–µ–µ `scratch` –æ–±—Ä–∞–∑–∞. –ó–¥–µ—Å—å –ø–æ–∫–∞–∑–∞–Ω–∞ —Å–≤—è–∑–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–∞–∫–µ—Ç–∞ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è `Gitlab`-a

    ```Dockerfile
    # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
    #                         Base image                          #
    #               First stage, prepare environment              #
    # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
    FROM python:3.11-astra1.8.2-slim AS base-stage

    SHELL [ "/bin/bash", "-exo", "pipefail", "-c" ]

    # hadolint ignore=DL3013,DL3042
    RUN \
        --mount=type=bind,source=./scripts,target=/usr/local/sbin,readonly \
        apt-install.sh git \
        && pip-env.sh pip install setuptools \
        && pip-env.sh pip install \
            --prefix=/additional-package \
            "git+https://gitlab-ci-token:${CI_JOB_TOKEN}@gitlab.com/python/package-lib.git"
    ```

2. –í—Ç–æ—Ä—ã–º —ç—Ç–∞–ø–æ–º, –º—ã –¥–æ–ø–æ–ª–Ω—è–µ–º –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–π `scratch` –æ–±—Ä–∞–∑ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–º –ø–∞–∫–µ—Ç–æ–≤ –ø–æ –ø—É—Ç–∏ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –ø–∞–∫–µ—Ç–æ–≤(–≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –ø—É—Ç—å –±—É–¥–µ—Ç `/usr/local/lib/python-venv/`), –Ω–∞–ø–æ–ª–Ω—è–µ–º –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∏ –æ–±—ä—è–≤–ª—è–µ–º –∫–æ–º–∞–Ω–¥—É –µ–≥–æ –∑–∞–ø—É—Å–∫–∞

    ```Dockerfile
    # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
    #                        Final image                          #
    #              Third stage, compact optimize layer            #
    # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
    FROM python-scratch-prepared-bundle:1.0.0

    COPY --from=base-stage /additional-package/ /usr/local/lib/python-venv/

    WORKDIR /usr/src/app

    COPY --chmod=644 ./app.py ./app.py
    COPY --chmod=755 lib/ lib/
    COPY --chmod=755 etc/ etc/

    EXPOSE 5052

    CMD ["gunicorn", "--certfile", "etc/service.crt", "--keyfile", "etc/service.key",  "-b", "0.0.0.0:5052", "--timeout", "180", "app:create_app()"]
    ```

–ü–æ–ª–Ω—ã–π `Dockerfile`:

```Dockerfile
# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
#                         Base image                          #
#               First stage, prepare environment              #
# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
FROM python:3.11-astra1.8.2-slim AS base-stage

SHELL [ "/bin/bash", "-exo", "pipefail", "-c" ]

# hadolint ignore=DL3013,DL3042
RUN \
    --mount=type=bind,source=./scripts,target=/usr/local/sbin,readonly \
    apt-install.sh git \
    && pip-env.sh pip install setuptools \
    && pip-env.sh pip install \
        --prefix=/additional-package \
        "git+https://gitlab-ci-token:${CI_JOB_TOKEN}@gitlab.com/python/package-lib.git"

# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
#                        Final image                          #
#              Third stage, compact optimize layer            #
# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
FROM python-scratch-prepared-bundle:1.0.0

COPY --from=base-stage /additional-package/ /usr/local/lib/python-venv/

WORKDIR /usr/src/app

COPY --chmod=644 ./app.py ./app.py
COPY --chmod=755 lib/ lib/
COPY --chmod=755 etc/ etc/

EXPOSE 5052

CMD ["gunicorn", "--certfile", "etc/service.crt", "--keyfile", "etc/service.key",  "-b", "0.0.0.0:5052", "--timeout", "180", "app:create_app()"]
```

–í–æ–∑–º–æ–∂–Ω–æ, –º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏—Å—å –∏–Ω—ã–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä –∫–æ–º–ø–∏–ª—è—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Python

1. `PyInstaller`

    ```console
    $ pip install pyinstaller
    $ pyinstaller --onefile --add-data 'venv/lib/python3.11/site-packages;pandas' app.py

    ...compiling binary...
    ```

2. `PEX`(Python EXecutable)

    ```console
    $ pex pandas -o app.pex -m app

    ...prepared app.pex file...
    ```

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –º–æ–∂–Ω–æ –∏–∑—É—á–∏—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—è[^4]

## [Miscellaneous](#contents)

–õ–æ–≥–æ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ–∑–¥–∞–Ω–æ –ø—Ä–∏ –ø–æ–º–æ—â–∏ [`aasvg`](https://github.com/martinthomson/aasvg) –ø—Ä–æ–µ–∫—Ç–∞. –í—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞—Ç—å —Ç–∞–∫–æ–µ –∂–µ –∏/–∏–ª–∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∏–º–µ—é—â–µ–µ—Å—è. –î–ª—è —ç—Ç–æ–≥–æ –≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å [—Å–∞–π—Ç–æ–º](https://patorjk.com/software/taag/#p=display&f=Doom) –∏–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `figlet`. –ï—Å–ª–∏ –í—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ —Å–ø–æ—Å–æ–± —Å —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π `figlet`, —Ç–æ –≤–¥–æ–±–∞–≤–æ–∫ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–∫–∞–∑–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π —à—Ä–∏—Ñ—Ç, –Ω–∞–ø—Ä–∏–º–µ—Ä —è –∏—Å–ø–æ–ª—å–∑—É—é `Doom`. –î–∞–ª–µ–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è `aasvg` –∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å `ascii` –∞—Ä—Ç –≤ `svg`. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ - –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –±—É–¥–µ—Ç svg –≤ –∫—Ä–∞—Å–Ω–æ–º —Ü–≤–µ—Ç–µ, —á—Ç–æ–±—ã –∏–∑–º–µ–Ω–∏—Ç—å —Ü–≤–µ—Ç, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏–∑–º–µ–Ω–∏—Ç—å –µ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ [—Ç—É—Ç](docs/images/logo.svg#L76)

```console
$ curl 'http://www.figlet.org/fonts/doom.flf' -o /usr/share/figlet/doom.flf
$ curl 'http://www.figlet.org/fonts/larry3d.flf' -o /usr/share/figlet/larry3d.flf
$ figlet -f doom 'Python'

______      _   _
| ___ \    | | | |
| |_/ /   _| |_| |__   ___  _ __
|  __/ | | | __| '_ \ / _ \| '_ \
| |  | |_| | |_| | | | (_) | | | |
\_|   \__, |\__|_| |_|\___/|_| |_|
       __/ |
      |___/

$ aasvg --source --embed < ./docs/ascii.txt > docs/images/logo.svg
```

<!-- markdownlint-disable MD033 MD041 MD051 -->
<table align="center"><tr><td align="center" width="9999">
<img src="docs/images/petuhon-cya.png" align="center" alt="Python Chicken Chimera">

<div align="center"> <sub> –ü–∏—Ç–æ–Ω–æ–≤—ã–π –ü–µ—Ç—É—Ö–æ–Ω –ø–æ–¥ –∞–≤—Ç–æ—Ä—Å—Ç–≤–æ–º <a href="https://chat.qwen.ai/">qwen.ai</a>. </sub> </div>

### [Cya!](#contents)

</td></tr></table>
<!-- markdownlint-enable MD033 MD041 MD051 -->

---

[^1]: üõ†Ô∏è –ù–∞–ø—Ä–∏–º–µ—Ä –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–≤–æ–π –ø—Ä–∏–≤–∞—Ç–Ω—ã–π —Ä–µ–µ—Å—Ç—Ä –æ–±—Ä–∞–∑–æ–≤: `--build-arg image_registry=my-container-registry:1111/`
[^2]: üõ†Ô∏è –ó–∞ —Å—á—ë—Ç —Å–∫—Ä–∏–ø—Ç–∞ [`python-install-approximately.sh`](scripts/python-install-approximately.sh) –Ω–∞—Å –º–æ–∂–µ—Ç –Ω–µ –≤–æ–ª–Ω–æ–≤–∞—Ç—å –ø–æ–ª–Ω–∞—è –≤–µ—Ä—Å–∏—è Python, –º—ã –º–æ–∂–µ–º –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –ª–∏—à—å –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ –∂–µ–ª–∞–µ–º—É—é –≤–µ—Ä—Å–∏—é, –∞ —Å–∫—Ä–∏–ø—Ç –ø–æ–∑–∞–±–æ—Ç–∏—Ç—Å—è —á—Ç–æ–±—ã –±—ã–ª–∞ –≤—ã–±—Ä–∞–Ω–∞ –ø–æ—Å–ª–µ–¥–Ω—è—è –∏ –∞–∫—Ç—É–∞–ª—å–Ω–∞—è –∏–∑ —Å–ø–∏—Å–∫–∞
[^3]: üõ†Ô∏è –ó–∞ —Å—á—ë—Ç —Å–∫—Ä–∏–ø—Ç–∞ [`python-set-proxy.sh`](scripts/python-set-proxy.sh) –º—ã –º–æ–∂–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∏ –¥—Ä—É–≥–∏–º –Ω–∞–±–æ—Ä–æ–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤, —Ç–∞–∫–∏—Ö –∫–∞–∫: `package_registry_proxy` –∏ `package_registry_trust_host`
[^4]: üõ†Ô∏è [–°—Ç–∞—Ç–∏—á–µ—Å–∫–æ–µ Python –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ –æ–±—Ä–∞–∑–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –Ω–∞ –±–∞–∑–µ scratch](https://habr.com/ru/articles/676412/)
